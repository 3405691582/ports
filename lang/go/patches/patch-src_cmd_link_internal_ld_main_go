Index: src/cmd/link/internal/ld/main.go
--- src/cmd/link/internal/ld/main.go.orig
+++ src/cmd/link/internal/ld/main.go
@@ -336,6 +336,12 @@ func Main(arch *sys.Arch, theArch Arch) {
 	bench.Start("layout")
 	filesize := ctxt.layout(order)
 
+	// Generate additional symbols just prior to output.
+	bench.Start("GenSymsLate")
+	if thearch.GenSymsLate != nil {
+		thearch.GenSymsLate(ctxt, ctxt.loader)
+	}
+
 	// Write out the output file.
 	// It is split into two parts (Asmb and Asmb2). The first
 	// part writes most of the content (sections and segments),
@@ -358,9 +364,9 @@ func Main(arch *sys.Arch, theArch Arch) {
 
 	// Generate additional symbols for the native symbol table just prior
 	// to code generation.
-	bench.Start("GenSymsLate")
-	if thearch.GenSymsLate != nil {
-		thearch.GenSymsLate(ctxt, ctxt.loader)
+	bench.Start("GenSymsLate2")
+	if thearch.GenSymsLate2 != nil {
+		thearch.GenSymsLate2(ctxt, ctxt.loader)
 	}
 
 	bench.Start("Asmb2")
