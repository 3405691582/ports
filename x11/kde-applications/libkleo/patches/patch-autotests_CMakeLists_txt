Index: autotests/CMakeLists.txt
--- autotests/CMakeLists.txt.orig
+++ autotests/CMakeLists.txt
@@ -11,25 +11,30 @@ if(NOT TARGET Qt${QT_MAJOR_VERSION}::Test)
     return()
 endif()
 
+# target_include_directories does not handle empty include paths
+include_directories("${CMAKE_INSTALL_PREFIX}/include"
+                    "${CMAKE_INSTALL_PREFIX}/include/gpgme++"
+                    "${CMAKE_INSTALL_PREFIX}/include/qgpgme")
+
 ecm_add_test(
     flatkeylistmodeltest.cpp
     abstractkeylistmodeltest.cpp
     TEST_NAME flatkeylistmodeltest
-    LINK_LIBRARIES KF5::Libkleo Qt${QT_MAJOR_VERSION}::Test
+    LINK_LIBRARIES KF5::Libkleo Qt${QT_MAJOR_VERSION}::Test  gpgmepp qgpgme
 )
 
 ecm_add_test(
     hierarchicalkeylistmodeltest.cpp
     abstractkeylistmodeltest.cpp
     TEST_NAME hierarchicalkeylistmodeltest
-    LINK_LIBRARIES KF5::Libkleo Qt${QT_MAJOR_VERSION}::Test
+    LINK_LIBRARIES KF5::Libkleo Qt${QT_MAJOR_VERSION}::Test gpgmepp qgpgme
 )
 
 ecm_add_test(
     keyresolvercoretest.cpp
     keyresolvercoretest.qrc
     TEST_NAME keyresolvercoretest
-    LINK_LIBRARIES KF5::Libkleo Qt${QT_MAJOR_VERSION}::Test
+    LINK_LIBRARIES KF5::Libkleo Qt${QT_MAJOR_VERSION}::Test gpgmepp qgpgme
 )
 
 ecm_add_tests(
